# check_and_fix.py - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏ü‡∏•‡πå
# -------------------------------------------------------------------
import os
import glob

def check_csv_files():
    """‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏ü‡∏•‡πå CSV ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î"""
    print("üîç ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏ü‡∏•‡πå CSV...")
    print("=" * 50)
    
    # ‡∏´‡∏≤‡πÑ‡∏ü‡∏•‡πå CSV ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
    csv_files = []
    
    # ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
    for file in glob.glob("*.csv"):
        csv_files.append(file)
        print(f"‚úÖ ‡∏û‡∏ö‡πÑ‡∏ü‡∏•‡πå: {file}")
    
    # ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå data
    for file in glob.glob("data/*.csv"):
        csv_files.append(file)
        print(f"‚úÖ ‡∏û‡∏ö‡πÑ‡∏ü‡∏•‡πå: {file}")
    
    # ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
    required_files = ['BTC_yfinance_daily.csv', 'LTC_yfinance_daily.csv']
    missing = []
    
    for req_file in required_files:
        found = False
        for csv_file in csv_files:
            if req_file.lower() in csv_file.lower():
                found = True
                print(f"\nüìä {req_file} -> ‡∏û‡∏ö‡∏ó‡∏µ‡πà: {csv_file}")
                
                # ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô root ‡πÉ‡∏´‡πâ copy ‡∏°‡∏≤
                if csv_file != req_file:
                    import shutil
                    try:
                        shutil.copy2(csv_file, req_file)
                        print(f"‚úÖ ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏≤‡∏ó‡∏µ‡πà root directory ‡πÅ‡∏•‡πâ‡∏ß")
                    except Exception as e:
                        print(f"‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå: {e}")
                break
        
        if not found:
            missing.append(req_file)
    
    if missing:
        print(f"\n‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÑ‡∏ü‡∏•‡πå: {', '.join(missing)}")
    else:
        print("\n‚úÖ ‡∏û‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡πÑ‡∏ü‡∏•‡πå!")
    
    return len(missing) == 0

def list_all_files():
    """‡πÅ‡∏™‡∏î‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ"""
    print("\nüìÅ ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ:")
    print("=" * 50)
    
    # Python files
    print("\nüêç Python Files:")
    for file in glob.glob("*.py"):
        size = os.path.getsize(file) / 1024  # KB
        print(f"  - {file} ({size:.1f} KB)")
    
    # CSV files
    print("\nüìä CSV Files:")
    for file in glob.glob("*.csv") + glob.glob("data/*.csv"):
        size = os.path.getsize(file) / 1024  # KB
        print(f"  - {file} ({size:.1f} KB)")
    
    # Directories
    print("\nüìÅ Directories:")
    for dir_name in ['modules', 'ai_models', 'logs', 'data']:
        if os.path.exists(dir_name):
            print(f"  ‚úÖ {dir_name}/")
        else:
            print(f"  ‚ùå {dir_name}/ (not found)")

def quick_fix():
    """‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß"""
    print("\nüîß Quick Fix...")
    
    # ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô
    for folder in ['data', 'logs', 'modules', 'ai_models']:
        os.makedirs(folder, exist_ok=True)
    
    print("‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏•‡πâ‡∏ß")

def main():
    print("üîç ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö Trading Bot")
    print("=" * 70)
    
    # ‡πÅ‡∏™‡∏î‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
    list_all_files()
    
    # ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏ü‡∏•‡πå CSV
    csv_ok = check_csv_files()
    
    # Quick fix
    quick_fix()
    
    print("\n" + "=" * 70)
    if csv_ok:
        print("‚úÖ ‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô!")
        print("\n‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ï‡πà‡∏≠‡πÑ‡∏õ:")
        print("1. ‡∏£‡∏±‡∏ô: python prepare_and_run.py")
        print("2. ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏±‡∏ô: python ai_trainer.py (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)")
    else:
        print("‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÑ‡∏ü‡∏•‡πå CSV")
        print("\n‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:")
        print("1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÑ‡∏ü‡∏•‡πå CSV ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á")
        print("2. ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏±‡∏ô: python prepare_and_run.py (‡∏à‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏´‡πâ)")

if __name__ == "__main__":
    main()
